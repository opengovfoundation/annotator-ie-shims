var logFns="log info warn error assert dir clear profile profileEnd".split(" ");"undefined"==typeof console&&(console={});for(var i in logFns){var method=logFns[i];"undefined"==typeof console[method]&&(console[method]=function(){})}if(Function.prototype.bind&&"object"==typeof console&&"object"==typeof console.log)for(i in logFns)method=logFns[i],console[method]=Function.prototype.call.bind(console[method],console);
var Node=Node||{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16};(function(A){function p(b){return 10>b?"0"+b:b}function U(n){b.lastIndex=0;return b.test(n)?'"'+n.replace(b,function(b){var n=Q[b];return"string"===typeof n?n:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function n(b,A){var C,s,p,F,D=u,q,r=A[b];r&&("object"===typeof r&&"function"===typeof r.toJSON)&&(r=r.toJSON(b));"function"===typeof K&&(r=K.call(A,b,r));switch(typeof r){case "string":return U(r);case "number":return isFinite(r)?String(r):"null";case "boolean":case "null":return String(r);
case "object":if(!r)return"null";u+=B;q=[];if("[object Array]"===Object.prototype.toString.apply(r)){F=r.length;for(C=0;C<F;C+=1)q[C]=n(C,r)||"null";p=0===q.length?"[]":u?"[\n"+u+q.join(",\n"+u)+"\n"+D+"]":"["+q.join(",")+"]";u=D;return p}if(K&&"object"===typeof K)for(F=K.length,C=0;C<F;C+=1)"string"===typeof K[C]&&(s=K[C],(p=n(s,r))&&q.push(U(s)+(u?": ":":")+p));else for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(p=n(s,r))&&q.push(U(s)+(u?": ":":")+p);p=0===q.length?"{}":u?"{\n"+u+q.join(",\n"+
u)+"\n"+D+"}":"{"+q.join(",")+"}";u=D;return p}}"undefined"===typeof exports&&("function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(b){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+p(this.getUTCMonth()+1)+"-"+p(this.getUTCDate())+"T"+p(this.getUTCHours())+":"+p(this.getUTCMinutes())+":"+p(this.getUTCSeconds())+"Z":null}),"function"!==typeof String.prototype.toJSON&&(String.prototype.toJSON=function(b){return this.valueOf()}),"function"!==typeof Number.prototype.toJSON&&
(Number.prototype.toJSON=function(b){return this.valueOf()}),"function"!==typeof Boolean.prototype.toJSON&&(Boolean.prototype.toJSON=function(b){return this.valueOf()}));var D=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,u,B,Q={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},K;"function"!==
typeof A.stringify&&(A.stringify=function(b,p,C){var s;B=u="";if("number"===typeof C)for(s=0;s<C;s+=1)B+=" ";else"string"===typeof C&&(B=C);if((K=p)&&"function"!==typeof p&&("object"!==typeof p||"number"!==typeof p.length))throw Error("JSON.stringify");return n("",{"":b})});"function"!==typeof A.parse&&(A.parse=function(b,n){function p(b,s){var u,q,r=b[s];if(r&&"object"===typeof r)for(u in r)Object.prototype.hasOwnProperty.call(r,u)&&(q=p(r,u),void 0!==q?r[u]=q:delete r[u]);return n.call(b,s,r)}var s;
b=String(b);D.lastIndex=0;D.test(b)&&(b=b.replace(D,function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return s=eval("("+b+")"),"function"===typeof n?p({"":s},""):s;throw new SyntaxError("JSON.parse");})})("undefined"!==typeof exports?exports:window.JSON?window.JSON:window.JSON={});(function(A,p){"function"===typeof define&&define.amd?define(p):"object"===typeof exports?module.exports=p():A.returnExports=p()})(this,function(){function A(f){f=+f;f!==f?f=0:0!==f&&(f!==1/0&&f!==-(1/0))&&(f=(0<f||-1)*Math.floor(Math.abs(f)));return f}function p(f){var d=typeof f;return null===f||"undefined"===d||"boolean"===d||"number"===d||"string"===d}function U(){}var n=Array.prototype,D=Object.prototype,b=Function.prototype,u=String.prototype,B=Number.prototype,Q=n.slice,K=n.splice,aa=n.unshift,
N=b.call,C=D.toString,s=function(f){return"[object Function]"===D.toString.call(f)},ha=function(f){return"[object Array]"===C.call(f)},F=function(f){return"[object String]"===C.call(f)},ba=function(f){var d="[object Arguments]"===C.call(f);d||(d=!ha(f)&&null!==f&&"object"===typeof f&&"number"===typeof f.length&&0<=f.length&&s(f.callee));return d},q;if(q=Object.defineProperty)try{Object.defineProperty({},"x",{}),q=!0}catch(r){q=!1}var ka;ka=q?function(f,d,c,a){!a&&d in f||Object.defineProperty(f,d,
{configurable:!0,enumerable:!1,writable:!0,value:c})}:function(f,d,c,a){!a&&d in f||(f[d]=c)};q=function(f,d,c){for(var a in d)D.hasOwnProperty.call(d,a)&&ka(f,a,d[a],c)};var O=function(f){if(null==f)throw new TypeError("can't convert "+f+" to object");return Object(f)};q(b,{bind:function(f){var d=this;if(!s(d))throw new TypeError("Function.prototype.bind called on incompatible "+d);for(var c=Q.call(arguments,1),a=Math.max(0,d.length-c.length),y=[],g=0;g<a;g++)y.push("$"+g);var b=Function("binder",
"return function ("+y.join(",")+"){return binder.apply(this,arguments)}")(function(){if(this instanceof b){var a=d.apply(this,c.concat(Q.call(arguments)));return Object(a)===a?a:this}return d.apply(f,c.concat(Q.call(arguments)))});d.prototype&&(U.prototype=d.prototype,b.prototype=new U,U.prototype=null);return b}});var L=N.bind(D.hasOwnProperty);L(D,"__defineGetter__")&&(N.bind(D.__defineGetter__),N.bind(D.__defineSetter__),N.bind(D.__lookupGetter__),N.bind(D.__lookupSetter__));b=function(){var f=
[1,2],d=f.splice();return 2===f.length&&ha(d)&&0===d.length}();q(n,{splice:function(f,d){return 0===arguments.length?[]:K.apply(this,arguments)}},b);b=function(){var f={};n.splice.call(f,0,0,1);return 1===f.length}();q(n,{splice:function(f,d){if(0===arguments.length)return[];var c=arguments;this.length=Math.max(A(this.length),0);0<arguments.length&&"number"!==typeof d&&(c=Q.call(arguments),2>c.length?c.push(this.length-f):c[1]=A(d));return K.apply(this,c)}},!b);b=1!==[].unshift(0);q(n,{unshift:function(){aa.apply(this,
arguments);return this.length}},b);q(Array,{isArray:ha});var b=Object("a"),I="a"!==b[0]||!(0 in b),b=function(f){var d=!0,c=!0;f&&(f.call("foo",function(f,c,a){"object"!==typeof a&&(d=!1)}),f.call([1],function(){c="string"===typeof this},"x"));return!!f&&d&&c};q(n,{forEach:function(f,d){var c=O(this),a=I&&F(this)?this.split(""):c,y=-1,g=a.length>>>0;if(!s(f))throw new TypeError;for(;++y<g;)y in a&&f.call(d,a[y],y,c)}},!b(n.forEach));q(n,{map:function(f,d){var a=O(this),h=I&&F(this)?this.split(""):
a,y=h.length>>>0,g=Array(y);if(!s(f))throw new TypeError(f+" is not a function");for(var b=0;b<y;b++)b in h&&(g[b]=f.call(d,h[b],b,a));return g}},!b(n.map));q(n,{filter:function(f,d){var a=O(this),h=I&&F(this)?this.split(""):a,y=h.length>>>0,g=[],b;if(!s(f))throw new TypeError(f+" is not a function");for(var l=0;l<y;l++)l in h&&(b=h[l],f.call(d,b,l,a)&&g.push(b));return g}},!b(n.filter));q(n,{every:function(f,d){var a=O(this),h=I&&F(this)?this.split(""):a,y=h.length>>>0;if(!s(f))throw new TypeError(f+
" is not a function");for(var g=0;g<y;g++)if(g in h&&!f.call(d,h[g],g,a))return!1;return!0}},!b(n.every));q(n,{some:function(f,d){var a=O(this),h=I&&F(this)?this.split(""):a,g=h.length>>>0;if(!s(f))throw new TypeError(f+" is not a function");for(var b=0;b<g;b++)if(b in h&&f.call(d,h[b],b,a))return!0;return!1}},!b(n.some));b=!1;n.reduce&&(b="object"===typeof n.reduce.call("es5",function(f,d,a,h){return h}));q(n,{reduce:function(f){var a=O(this),c=I&&F(this)?this.split(""):a,h=c.length>>>0;if(!s(f))throw new TypeError(f+
" is not a function");if(!h&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var g=0,b;if(2<=arguments.length)b=arguments[1];else{do{if(g in c){b=c[g++];break}if(++g>=h)throw new TypeError("reduce of empty array with no initial value");}while(1)}for(;g<h;g++)g in c&&(b=f.call(void 0,b,c[g],g,a));return b}},!b);b=!1;n.reduceRight&&(b="object"===typeof n.reduceRight.call("es5",function(a,d,c,h){return h}));q(n,{reduceRight:function(a){var d=O(this),c=I&&F(this)?
this.split(""):d,h=c.length>>>0;if(!s(a))throw new TypeError(a+" is not a function");if(!h&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var g,h=h-1;if(2<=arguments.length)g=arguments[1];else{do{if(h in c){g=c[h--];break}if(0>--h)throw new TypeError("reduceRight of empty array with no initial value");}while(1)}if(0>h)return g;do h in c&&(g=a.call(void 0,g,c[h],h,d));while(h--);return g}},!b);b=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);q(n,{indexOf:function(a){var d=
I&&F(this)?this.split(""):O(this),c=d.length>>>0;if(!c)return-1;var h=0;1<arguments.length&&(h=A(arguments[1]));for(h=0<=h?h:Math.max(0,c+h);h<c;h++)if(h in d&&d[h]===a)return h;return-1}},b);b=Array.prototype.lastIndexOf&&-1!==[0,1].lastIndexOf(0,-3);q(n,{lastIndexOf:function(a){var d=I&&F(this)?this.split(""):O(this),c=d.length>>>0;if(!c)return-1;var h=c-1;1<arguments.length&&(h=Math.min(h,A(arguments[1])));for(h=0<=h?h:c-Math.abs(h);0<=h;h--)if(h in d&&a===d[h])return h;return-1}},b);var V=!{toString:null}.propertyIsEnumerable("toString"),
M=function(){}.propertyIsEnumerable("prototype"),R="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),m=R.length;q(Object,{keys:function(a){var d=s(a),c=ba(a),h=null!==a&&"object"===typeof a,g=h&&F(a);if(!h&&!d&&!c)throw new TypeError("Object.keys called on a non-object");h=[];d=M&&d;if(g||c)for(c=0;c<a.length;++c)h.push(String(c));else for(var b in a)d&&"prototype"===b||!L(a,b)||h.push(String(b));if(V)for(c=(c=a.constructor)&&c.prototype===
a,g=0;g<m;g++)b=R[g],c&&"constructor"===b||!L(a,b)||h.push(b);return h}});var b=Object.keys&&function(){return 2===Object.keys(arguments).length}(1,2),Y=Object.keys;q(Object,{keys:function(a){return ba(a)?Y(n.slice.call(a)):Y(a)}},!b);b=Date.prototype.toISOString&&-1===(new Date(-621987552E5)).toISOString().indexOf("-000001");q(Date.prototype,{toISOString:function(){var a,d,c,g;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");g=this.getUTCFullYear();
a=this.getUTCMonth();g+=Math.floor(a/12);a=[(a%12+12)%12+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()];g=(0>g?"-":9999<g?"+":"")+("00000"+Math.abs(g)).slice(0<=g&&9999>=g?-4:-6);for(d=a.length;d--;)c=a[d],10>c&&(a[d]="0"+c);return g+"-"+a.slice(0,2).join("-")+"T"+a.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"}},b);b=!1;try{b=Date.prototype.toJSON&&null===(new Date(NaN)).toJSON()&&-1!==(new Date(-621987552E5)).toJSON().indexOf("-000001")&&
Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(Z){}b||(Date.prototype.toJSON=function(a){a=Object(this);var d;a:if(p(a))d=a;else{d=a.valueOf;if(s(d)&&(d=d.call(a),p(d)))break a;d=a.toString;if(s(d)&&(d=d.call(a),p(d)))break a;throw new TypeError;}if("number"===typeof d&&!isFinite(d))return null;d=a.toISOString;if("function"!==typeof d)throw new TypeError("toISOString property is not callable");return d.call(a)});var b=1E15===Date.parse("+033658-09-27T01:46:40.000Z"),N=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||
!isNaN(Date.parse("2012-11-31T23:59:59.000Z")),da=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(!Date.parse||da||N||!b)Date=function(a){function d(c,g,h,b,y,W,t){var x=arguments.length;return this instanceof a?(x=1===x&&String(c)===c?new a(d.parse(c)):7<=x?new a(c,g,h,b,y,W,t):6<=x?new a(c,g,h,b,y,W):5<=x?new a(c,g,h,b,y):4<=x?new a(c,g,h,b):3<=x?new a(c,g,h):2<=x?new a(c,g):1<=x?new a(c):new a,x.constructor=d,x):a.apply(this,arguments)}function c(a,d){var c=1<d?1:0;return b[d]+Math.floor((a-1969+
c)/4)-Math.floor((a-1901+c)/100)+Math.floor((a-1601+c)/400)+365*(a-1970)}var g=RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),b=[0,31,59,90,120,151,181,212,243,273,304,334,365],l;for(l in a)d[l]=a[l];d.now=a.now;d.UTC=a.UTC;d.prototype=a.prototype;d.prototype.constructor=d;d.parse=function(d){var b=g.exec(d);if(b){var y=Number(b[1]),l=Number(b[2]||1)-1,k=Number(b[3]||1)-1,W=Number(b[4]||0),t=Number(b[5]||
0),x=Number(b[6]||0),ea=Math.floor(1E3*Number(b[7]||0)),n=Boolean(b[4]&&!b[8]),fa="-"===b[9]?1:-1,q=Number(b[10]||0),b=Number(b[11]||0);return W<(0<t||0<x||0<ea?24:25)&&(60>t&&60>x&&1E3>ea&&-1<l&&12>l&&24>q&&60>b&&-1<k&&k<c(y,l+1)-c(y,l))&&(y=60*(24*(c(y,l)+k)+W+q*fa),y=1E3*(60*(y+t+b*fa)+x)+ea,n&&(y=Number(new a(1970,0,1,0,0,0,y))),-864E13<=y&&864E13>=y)?y:NaN}return a.parse.apply(this,arguments)};return d}(Date);Date.now||(Date.now=function(){return(new Date).getTime()});var b=B.toFixed&&("0.000"!==
(8E-5).toFixed(3)||"1"!==(0.9).toFixed(0)||"1.25"!==(1.255).toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0)),w={base:1E7,size:6,data:[0,0,0,0,0,0],multiply:function(a,d){for(var c=-1;++c<w.size;)d+=a*w.data[c],w.data[c]=d%w.base,d=Math.floor(d/w.base)},divide:function(a){for(var d=w.size,c=0;0<=--d;)c+=w.data[d],w.data[d]=Math.floor(c/a),c=c%a*w.base},numToString:function(){for(var a=w.size,d="";0<=--a;)if(""!==d||0===a||0!==w.data[a])var c=String(w.data[a]),d=""===d?c:d+("0000000".slice(0,
7-c.length)+c);return d},pow:function d(a,g,b){return 0===g?b:1===g%2?d(a,g-1,b*a):d(a*a,g/2,b)},log:function(a){for(var c=0;4096<=a;)c+=12,a/=4096;for(;2<=a;)c+=1,a/=2;return c}};q(B,{toFixed:function(a){var c,g,b;a=Number(a);a=a!==a?0:Math.floor(a);if(0>a||20<a)throw new RangeError("Number.toFixed called with invalid number of decimals");c=Number(this);if(c!==c)return"NaN";if(-1E21>=c||1E21<=c)return String(c);g="";0>c&&(g="-",c=-c);b="0";if(1E-21<c)if(b=w.log(c*w.pow(2,69,1))-69,c=0>b?c*w.pow(2,
-b,1):c/w.pow(2,b,1),c*=4503599627370496,b=52-b,0<b){w.multiply(0,c);for(c=a;7<=c;)w.multiply(1E7,0),c-=7;w.multiply(w.pow(10,c,1),0);for(c=b-1;23<=c;)w.divide(8388608),c-=23;w.divide(1<<c);w.multiply(1,1);w.divide(2);b=w.numToString()}else w.multiply(0,c),w.multiply(1<<-b,0),b=w.numToString()+"0.00000000000000000000".slice(2,2+a);0<a?(c=b.length,b=c<=a?g+"0.0000000000000000000".slice(0,a-c+2)+b:g+b.slice(0,c-a)+"."+b.slice(c-a)):b=g+b;return b}},b);var ca=u.split;2!=="ab".split(/(?:ab)*/).length||
4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||1<".".split(/()()/).length?function(){var a=void 0===/()??/.exec("")[1];u.split=function(c,g){var b=this;if(void 0===c&&0===g)return[];if("[object RegExp]"!==C.call(c))return ca.call(this,c,g);var l=[],k=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.extended?"x":"")+(c.sticky?"y":""),q=0,m,p,s;c=RegExp(c.source,k+"g");b+="";a||(m=RegExp("^"+c.source+"$(?!\\s)",k));for(g=void 0===
g?4294967295:g>>>0;p=c.exec(b);){k=p.index+p[0].length;if(k>q&&(l.push(b.slice(q,p.index)),!a&&1<p.length&&p[0].replace(m,function(){for(var a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(p[a]=void 0)}),1<p.length&&p.index<b.length&&n.push.apply(l,p.slice(1)),s=p[0].length,q=k,l.length>=g))break;c.lastIndex===p.index&&c.lastIndex++}q===b.length?!s&&c.test("")||l.push(""):l.push(b.slice(q));return l.length>g?l.slice(0,g):l}}():"0".split(void 0,0).length&&(u.split=function(a,c){return void 0===
a&&0===c?[]:ca.call(this,a,c)});var a=u.replace;(function(){var a=[];"x".replace(/x(.)?/g,function(c,g){a.push(g)});return 1===a.length&&"undefined"===typeof a[0]})()||(u.replace=function(g,c){var b=s(c),l="[object RegExp]"===D.toString.call(g)&&/\)[*?]/.test(g.source);return b&&l?a.call(this,g,function(a){var b=arguments.length,h=g.lastIndex;g.lastIndex=0;var l=g.exec(a);g.lastIndex=h;l.push(arguments[b-2],arguments[b-1]);return c.apply(this,l)}):a.call(this,g,c)});var g=u.substr,B="".substr&&"b"!==
"0b".substr(-1);q(u,{substr:function(a,c){return g.call(this,0>a?0>(a=this.length+a)?0:a:a,c)}},B);var l=RegExp("^[\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*"),k=RegExp("[\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$"),
B=u.trim&&("\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff".trim()||!"\u200b".trim());q(u,{trim:function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(l,"").replace(k,"")}},B);if(8!==parseInt("\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff08")||22!==parseInt("\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff0x16"))parseInt=
function(a){var g=/^0[xX]/;return function(b,l){b=String(b).trim();Number(l)||(l=g.test(b)?16:10);return a(b,l)}}(parseInt)});(function(A,p){"function"==typeof define&&define.amd?define(A):"undefined"!=typeof module&&"object"==typeof exports?module.exports=A():p.rangy=A()})(function(){function A(a,g){var b=typeof a[g];return b==ha||!(b!=s||!a[g])||"unknown"==b}function p(a,g){return!(typeof a[g]!=s||!a[g])}function U(a,g){return typeof a[g]!=F}function n(a){return function(g,b){for(var k=b.length;k--;)if(!a(g,b[k]))return!1;return!0}}function D(a){return a&&O(a,ka)&&I(a,r)}function b(a){return p(a,"body")?a.body:a.getElementsByTagName("body")[0]}
function u(a){typeof console!=F&&A(console,"log")&&console.log(a)}function B(a){m.initialized=!0;m.supported=!1;a="Rangy is not supported in this environment. Reason: "+a;M&&m.config.alertOnFail?alert(a):u(a)}function Q(){if(M&&!m.initialized){var a,g=!1,l=!1;A(document,"createRange")&&(a=document.createRange(),O(a,q)&&I(a,ba)&&(g=!0));if((a=b(document))&&"body"==a.nodeName.toLowerCase())if(a&&A(a,"createTextRange")&&(a=a.createTextRange(),D(a)&&(l=!0)),g||l){m.initialized=!0;m.features={implementsDomRange:g,
implementsTextRange:l};var k,f;for(f in V)(k=V[f])instanceof aa&&k.init(k,m);l=0;for(k=da.length;l<k;++l)try{da[l](m)}catch(d){g="Rangy init listener threw an exception. Continuing. Detail: "+(d.message||d.description||String(d)),u(g)}}else B("Neither Range nor TextRange are available");else B("No body element found")}}function K(a){a=a||window;Q();for(var b=0,l=w.length;b<l;++b)w[b](a)}function aa(a,b,l){this.name=a;this.dependencies=b;this.supported=this.initialized=!1;this.initializer=l}function N(a,
b,l){b=new aa(a,b,function(b){if(!b.initialized){b.initialized=!0;try{l(m,b),b.supported=!0}catch(g){u("Module '"+a+"' failed to load: "+(g.message||g.description||String(g)))}}});return V[a]=b}function C(){}var s="object",ha="function",F="undefined",ba="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),q="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),
r="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),ka="collapse compareEndPoints duplicate moveToElementText parentElement select setEndPoint getBoundingClientRect".split(" "),O=n(A),L=n(p),I=n(U),V={},M=typeof window!=F&&typeof document!=F,R={isHostMethod:A,isHostObject:p,isHostProperty:U,areHostMethods:O,areHostObjects:L,areHostProperties:I,isTextRange:D,getBody:b},m={version:"1.3.0-alpha.20140827",initialized:!1,isBrowser:M,supported:!0,util:R,features:{},modules:V,
config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==F?!0:rangyAutoInitialize}};m.fail=B;m.warn=function(a){a="Rangy warning: "+a;M&&m.config.alertOnWarn?alert(a):u(a)};var Y;({}).hasOwnProperty?(R.extend=Y=function(a,b,l){var k,f,d;for(d in b)b.hasOwnProperty(d)&&(k=a[d],f=b[d],l&&(null!==k&&"object"==typeof k&&null!==f&&"object"==typeof f)&&Y(k,f,!0),a[d]=f);b.hasOwnProperty("toString")&&(a.toString=b.toString);return a},R.createOptions=function(a,
b){var l={};Y(l,b);a&&Y(l,a,!0);return l}):B("hasOwnProperty not supported");M||B("Rangy can only run in a browser");(function(){var a;if(M){var b=document.createElement("div");b.appendChild(document.createElement("span"));var l=[].slice;try{1==l.call(b.childNodes,0)[0].nodeType&&(a=function(a){return l.call(a,0)})}catch(k){}}a||(a=function(a){for(var b=[],c=0,g=a.length;c<g;++c)b[c]=a[c];return b});R.toArray=a})();var Z;M&&(A(document,"addEventListener")?Z=function(a,b,l){a.addEventListener(b,l,
!1)}:A(document,"attachEvent")?Z=function(a,b,l){a.attachEvent("on"+b,l)}:B("Document does not have required addEventListener or attachEvent method"),R.addListener=Z);var da=[];m.init=Q;m.addInitListener=function(a){m.initialized?a(m):da.push(a)};var w=[];m.addShimListener=function(a){w.push(a)};M&&(m.shim=m.createMissingNativeApi=K);aa.prototype={init:function(){for(var a=this.dependencies||[],b=0,l=a.length,k,f;b<l;++b){f=a[b];k=V[f];if(!(k&&k instanceof aa))throw Error("required module '"+f+"' not found");
k.init();if(!k.supported)throw Error("required module '"+f+"' not supported");}this.initializer(this)},fail:function(a){this.initialized=!0;this.supported=!1;throw Error("Module '"+this.name+"' failed to load: "+a);},warn:function(a){m.warn("Module "+this.name+": "+a)},deprecationNotice:function(a,b){m.warn("DEPRECATED: "+a+" in module "+this.name+"is deprecated. Please use "+b+" instead")},createError:function(a){return Error("Error in Rangy "+this.name+" module: "+a)}};m.createModule=function(a){var b,
l;2==arguments.length?(b=arguments[1],l=[]):(b=arguments[2],l=arguments[1]);b=N(a,l,b);m.initialized&&m.supported&&b.init()};m.createCoreModule=function(a,b,l){N(a,b,l)};m.RangePrototype=C;m.rangePrototype=new C;m.selectionPrototype=new function(){};m.createCoreModule("DomUtil",[],function(a,b){function l(a){for(var b=0;a=a.previousSibling;)++b;return b}function k(a,b){var c=[],d;for(d=a;d;d=d.parentNode)c.push(d);for(d=b;d;d=d.parentNode)if(ma(c,d))return d;return null}function f(a,b,c){for(b=c?
b:b.parentNode;b;){if(b===a)return!0;b=b.parentNode}return!1}function d(a,b,c){for(c=c?a:a.parentNode;c;){a=c.parentNode;if(a===b)return c;c=a}return null}function c(a){a=a.nodeType;return 3==a||4==a||8==a}function h(a,b){var c=b.nextSibling,d=b.parentNode;c?d.insertBefore(a,c):d.appendChild(a);return a}function y(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=t)return a.ownerDocument;if(typeof a.document!=t)return a.document;if(a.parentNode)return y(a.parentNode);throw b.createError("getDocument: no document found for node");
}function q(a){a=y(a);if(typeof a.defaultView!=t)return a.defaultView;if(typeof a.parentWindow!=t)return a.parentWindow;throw b.createError("Cannot get a window object for node");}function p(a){if(typeof a.contentDocument!=t)return a.contentDocument;if(typeof a.contentWindow!=t)return a.contentWindow.document;throw b.createError("getIframeDocument: No Document object found for iframe element");}function n(a){return a&&x.isHostMethod(a,"setTimeout")&&x.isHostObject(a,"document")}function m(a){return a?
c(a)?'"'+a.data+'"':1==a.nodeType?"<"+a.nodeName+(a.id?' id="'+a.id+'"':"")+">[index:"+l(a)+",length:"+a.childNodes.length+"]["+(a.innerHTML||"[innerHTML not supported]").slice(0,25)+"]":a.nodeName:"[No node]"}function s(a){this._next=this.root=a}function u(a,b){this.node=a;this.offset=b}function W(a){this.code=this[a];this.codeName=a;this.message="DOMException: "+this.codeName}var t="undefined",x=a.util;x.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method");
x.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var ea=document.createElement("div");x.areHostMethods(ea,["insertBefore","appendChild","cloneNode"])||b.fail("Incomplete Element implementation");x.isHostProperty(ea,"innerHTML")||b.fail("Element is missing innerHTML property");ea=document.createTextNode("test");x.areHostMethods(ea,["splitText","deleteData","insertData","appendData","cloneNode"])||b.fail("Incomplete Text Node implementation");var ma=
function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1},fa=!1;(function(){var b=document.createElement("b");b.innerHTML="1";b.innerHTML="<br>";fa=!1;a.features.crashyTextNodes=fa})();var ja;typeof window.getComputedStyle!=t?ja=function(a,b){return q(a).getComputedStyle(a,null)[b]}:typeof document.documentElement.currentStyle!=t?ja=function(a,b){return a.currentStyle[b]}:b.fail("No means of obtaining computed style properties found");s.prototype={_current:null,hasNext:function(){return!!this._next},
next:function(){var a=this._current=this._next,b;if(this._current){b=a.firstChild;if(!b)for(b=null;a!==this.root&&!(b=a.nextSibling);)a=a.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=null}};u.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+m(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};W.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,
WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24};W.prototype.toString=function(){return this.message};a.dom={arrayContains:ma,isHtmlNamespace:function(a){var b;return typeof a.namespaceURI==t||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b},parentElement:function(a){a=a.parentNode;return 1==a.nodeType?a:null},getNodeIndex:l,getNodeLength:function(a){switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;
default:return a.childNodes.length}},getCommonAncestor:k,isAncestorOf:f,isOrIsAncestorOf:function(a,b){return f(a,b,!0)},getClosestAncestorIn:d,isCharacterDataNode:c,isTextOrCommentNode:function(a){if(!a)return!1;a=a.nodeType;return 3==a||8==a},insertAfter:h,splitDataNode:function(a,b,c){var d=a.cloneNode(!1);d.deleteData(0,b);a.deleteData(b,a.length-b);h(d,a);if(c)for(var g=0,f;f=c[g++];)f.node==a&&f.offset>b?(f.node=d,f.offset-=b):f.node==a.parentNode&&f.offset>l(a)&&++f.offset;return d},getDocument:y,
getWindow:q,getIframeWindow:function(a){if(typeof a.contentWindow!=t)return a.contentWindow;if(typeof a.contentDocument!=t)return a.contentDocument.defaultView;throw b.createError("getIframeWindow: No Window object found for iframe element");},getIframeDocument:p,getBody:x.getBody,isWindow:n,getContentDocument:function(a,b,c){var d;a?x.isHostProperty(a,"nodeType")?d=1==a.nodeType&&"iframe"==a.tagName.toLowerCase()?p(a):y(a):n(a)&&(d=a.document):d=document;if(!d)throw b.createError(c+"(): Parameter must be a Window object or DOM node");
return d},getRootContainer:function(a){for(var b;b=a.parentNode;)a=b;return a},comparePoints:function(a,c,f,W){var h;if(a==f)return c===W?0:c<W?-1:1;if(h=d(f,a,!0))return c<=l(h)?-1:1;if(h=d(a,f,!0))return l(h)<W?-1:1;c=k(a,f);if(!c)throw Error("comparePoints error: nodes have no common ancestor");a=a===c?c:d(a,c,!0);f=f===c?c:d(f,c,!0);if(a===f)throw b.createError("comparePoints got to case 4 and childA and childB are the same!");for(c=c.firstChild;c;){if(c===a)return-1;if(c===f)return 1;c=c.nextSibling}},
isBrokenNode:function(a){return!1},inspectNode:m,getComputedStyleProperty:ja,fragmentFromNodeChildren:function(a){for(var b=y(a).createDocumentFragment(),c;c=a.firstChild;)b.appendChild(c);return b},createIterator:function(a){return new s(a)},DomPosition:u};a.DOMException=W});m.createCoreModule("DomRange",["DomUtil"],function(a,b){function l(a,e){return 3!=a.nodeType&&(I(a,e.startContainer)||I(a,e.endContainer))}function k(a){return a.document||M(a.startContainer)}function f(a){return new O(a.parentNode,
v(a))}function d(a){return new O(a.parentNode,v(a)+1)}function c(a,e,b){var c=11==a.nodeType?a.firstChild:a;J(e)?b==e.length?E.insertAfter(a,e):e.parentNode.insertBefore(a,0==b?e:U(e,b)):b>=e.childNodes.length?e.appendChild(a):e.insertBefore(a,e.childNodes[b]);return c}function h(a,e,b){G(a);G(e);if(k(e)!=k(a))throw new P("WRONG_DOCUMENT_ERR");var c=T(a.startContainer,a.startOffset,e.endContainer,e.endOffset);a=T(a.endContainer,a.endOffset,e.startContainer,e.startOffset);return b?0>=c&&0<=a:0>c&&
0<a}function q(a){for(var e,b,c=k(a.range).createDocumentFragment();b=a.next();){e=a.isPartiallySelectedSubtree();b=b.cloneNode(!e);e&&(e=a.getSubtreeIterator(),b.appendChild(q(e)),e.detach());if(10==b.nodeType)throw new P("HIERARCHY_REQUEST_ERR");c.appendChild(b)}return c}function p(a,e,b){var c,d;for(b=b||{stop:!1};c=a.next();)if(a.isPartiallySelectedSubtree())if(!1===e(c)){b.stop=!0;break}else{if(c=a.getSubtreeIterator(),p(c,e,b),c.detach(),b.stop)break}else for(c=E.createIterator(c);d=c.next();)if(!1===
e(d)){b.stop=!0;return}}function n(a){for(var e;a.next();)a.isPartiallySelectedSubtree()?(e=a.getSubtreeIterator(),n(e),e.detach()):a.remove()}function m(a){for(var e,b=k(a.range).createDocumentFragment(),c;e=a.next();){a.isPartiallySelectedSubtree()?(e=e.cloneNode(!1),c=a.getSubtreeIterator(),e.appendChild(m(c)),c.detach()):a.remove();if(10==e.nodeType)throw new P("HIERARCHY_REQUEST_ERR");b.appendChild(e)}return b}function s(a,e,b){var c=!(!e||!e.length),d,z=!!b;c&&(d=RegExp("^("+e.join("|")+")$"));
var g=[];p(new r(a,!1),function(e){if(!c||d.test(e.nodeType))if(!z||b(e)){var f=a.startContainer;e==f&&J(f)&&a.startOffset==f.length||(f=a.endContainer,e==f&&J(f)&&0==a.endOffset||g.push(e))}});return g}function u(a){return"["+("undefined"==typeof a.getName?"Range":a.getName())+"("+E.inspectNode(a.startContainer)+":"+a.startOffset+", "+E.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function r(a,e){this.range=a;this.clonePartiallySelectedTextNodes=e;if(!a.collapsed){this.sc=a.startContainer;this.so=
a.startOffset;this.ec=a.endContainer;this.eo=a.endOffset;var b=a.commonAncestorContainer;this.sc===this.ec&&J(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==b||J(this.sc)?N(this.sc,b,!0):this.sc.childNodes[this.so],this._last=this.ec!==b||J(this.ec)?N(this.ec,b,!0):this.ec.childNodes[this.eo-1])}}function W(a){return function(e,b){for(var c,d=b?e:e.parentNode;d;){c=d.nodeType;if(ga(a,c))return d;d=d.parentNode}return null}}
function t(a,e){if(na(a,e))throw new P("INVALID_NODE_TYPE_ERR");}function x(a,e){if(!ga(e,a.nodeType))throw new P("INVALID_NODE_TYPE_ERR");}function ea(a,e){if(0>e||e>(J(a)?a.length:a.childNodes.length))throw new P("INDEX_SIZE_ERR");}function ma(a,b){if(e(a,!0)!==e(b,!0))throw new P("WRONG_DOCUMENT_ERR");}function fa(a){if(z(a,!0))throw new P("NO_MODIFICATION_ALLOWED_ERR");}function ja(a,e){if(!a)throw new P(e);}function w(a){return L&&E.isBrokenNode(a)||!ga(V,a.nodeType)&&!e(a,!0)}function A(a){return!!a.startContainer&&
!!a.endContainer&&!w(a.startContainer)&&!w(a.endContainer)&&a.startOffset<=(J(a.startContainer)?a.startContainer.length:a.startContainer.childNodes.length)&&a.endOffset<=(J(a.endContainer)?a.endContainer.length:a.endContainer.childNodes.length)}function G(a){if(!A(a))throw Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")");}function ra(a,e){G(a);var b=a.startContainer,c=a.startOffset,d=a.endContainer,z=a.endOffset,f=b===d;J(d)&&(0<z&&z<d.length)&&U(d,z,e);J(b)&&(0<
c&&c<b.length)&&(b=U(b,c,e),f?(z-=c,d=b):d==b.parentNode&&z>=v(b)&&z++,c=0);a.setStartAndEnd(b,c,d,z)}function sa(a){G(a);var e=a.commonAncestorContainer.parentNode.cloneNode(!1);e.appendChild(a.cloneContents());return e.innerHTML}function C(a){a.START_TO_START=oa;a.START_TO_END=ta;a.END_TO_END=aa;a.END_TO_START=ha;a.NODE_BEFORE=Z;a.NODE_AFTER=da;a.NODE_BEFORE_AND_AFTER=ca;a.NODE_INSIDE=ba}function D(a){C(a);C(a.prototype)}function F(a,e){return function(){G(this);var b=this.startContainer,c=this.startOffset,
z=this.commonAncestorContainer,f=new r(this,!0);b!==z&&(b=N(b,z,!0),c=d(b),b=c.node,c=c.offset);p(f,fa);f.reset();z=a(f);f.detach();e(this,b,c,b,c);return z}}function B(e,b){function c(a,e){return function(b){x(b,R);x(ia(b),V);b=(a?f:d)(b);(e?z:g)(this,b.node,b.offset)}}function z(a,e,c){var d=a.endContainer,H=a.endOffset;if(e!==a.startContainer||c!==a.startOffset){if(ia(e)!=ia(d)||1==T(e,c,d,H))d=e,H=c;b(a,e,c,d,H)}}function g(a,e,c){var d=a.startContainer,H=a.startOffset;if(e!==a.endContainer||
c!==a.endOffset){if(ia(e)!=ia(d)||-1==T(e,c,d,H))d=e,H=c;b(a,d,H,e,c)}}var na=function(){};na.prototype=a.rangePrototype;e.prototype=new na;S.extend(e.prototype,{setStart:function(a,e){t(a,!0);ea(a,e);z(this,a,e)},setEnd:function(a,e){t(a,!0);ea(a,e);g(this,a,e)},setStartAndEnd:function(){var a=arguments,e=a[0],c=a[1],d=e,H=c;switch(a.length){case 3:H=a[2];break;case 4:d=a[2],H=a[3]}b(this,e,c,d,H)},setBoundary:function(a,e,b){this["set"+(b?"Start":"End")](a,e)},setStartBefore:c(!0,!0),setStartAfter:c(!1,
!0),setEndBefore:c(!0,!1),setEndAfter:c(!1,!1),collapse:function(a){G(this);a?b(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):b(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){t(a,!0);b(this,a,0,a,Q(a))},selectNode:function(a){t(a,!1);x(a,R);var e=f(a);a=d(a);b(this,e.node,e.offset,a.node,a.offset)},extractContents:F(m,b),deleteContents:F(n,b),canSurroundContents:function(){G(this);fa(this.startContainer);fa(this.endContainer);
var a=new r(this,!0),e=a._first&&l(a._first,this)||a._last&&l(a._last,this);a.detach();return!e},splitBoundaries:function(){ra(this)},splitBoundariesPreservingPositions:function(a){ra(this,a)},normalizeBoundaries:function(){G(this);var a=this.startContainer,e=this.startOffset,c=this.endContainer,d=this.endOffset,H=function(a){var e=a.nextSibling;e&&e.nodeType==a.nodeType&&(c=a,d=a.length,a.appendData(e.data),e.parentNode.removeChild(e))},z=function(b){var H=b.previousSibling;if(H&&H.nodeType==b.nodeType){a=
b;var z=b.length;e=H.length;b.insertData(0,H.data);H.parentNode.removeChild(H);a==c?(d+=e,c=a):c==b.parentNode&&(H=v(b),d==H?(c=b,d=z):d>H&&d--)}},f=!0;J(c)?c.length==d&&H(c):(0<d&&(f=c.childNodes[d-1])&&J(f)&&H(f),f=!this.collapsed);f?J(a)?0==e&&z(a):e<a.childNodes.length&&(H=a.childNodes[e])&&J(H)&&z(H):(a=c,e=d);b(this,a,e,c,d)},collapseToPoint:function(a,e){t(a,!0);ea(a,e);this.setStartAndEnd(a,e)}});D(e)}function X(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;
a.commonAncestorContainer=a.collapsed?a.startContainer:E.getCommonAncestor(a.startContainer,a.endContainer)}function K(a,e,b,c,d){a.startContainer=e;a.startOffset=b;a.endContainer=c;a.endOffset=d;a.document=E.getDocument(e);X(a)}function $(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this.document=a;X(this)}var E=a.dom,S=a.util,O=E.DomPosition,P=a.DOMException,J=E.isCharacterDataNode,v=E.getNodeIndex,I=E.isOrIsAncestorOf,M=E.getDocument,T=E.comparePoints,U=E.splitDataNode,
N=E.getClosestAncestorIn,Q=E.getNodeLength,ga=E.arrayContains,ia=E.getRootContainer,L=a.features.crashyTextNodes;r.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;a&&(this._next=a!==this._last?a.nextSibling:null,J(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-
this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so)));return a},remove:function(){var a=this._current,e,b;!J(a)||a!==this.sc&&a!==this.ec?a.parentNode&&a.parentNode.removeChild(a):(e=a===this.sc?this.so:0,b=a===this.ec?this.eo:a.length,e!=b&&a.deleteData(e,b-e))},isPartiallySelectedSubtree:function(){return l(this._current,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse(!1);else{a=new $(k(this.range));
var e=this._current,b=e,c=0,d=e,z=Q(e);I(e,this.sc)&&(b=this.sc,c=this.so);I(e,this.ec)&&(d=this.ec,z=this.eo);K(a,b,c,d,z)}return new r(a,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var R=[1,3,4,5,7,8,10],V=[2,9,11],Y=[1,3,4,5,7,8,10,11],la=[1,3,4,5,7,8],e=W([9,11]),z=W([5,6,10,12]),na=W([6,10,12]),ua=document.createElement("style"),pa=!1;try{ua.innerHTML="<b>x</b>",pa=3==ua.firstChild.nodeType}catch(va){}a.features.htmlParsingConforms=
pa;var qa="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),oa=0,ta=1,aa=2,ha=3,Z=0,da=1,ca=2,ba=3;S.extend(a.rangePrototype,{compareBoundaryPoints:function(a,e){G(this);ma(this.startContainer,e.startContainer);var b=a==ha||a==oa?"start":"end",c=a==ta||a==oa?"start":"end";return T(this[b+"Container"],this[b+"Offset"],e[c+"Container"],e[c+"Offset"])},insertNode:function(a){G(this);x(a,Y);fa(this.startContainer);if(I(a,this.startContainer))throw new P("HIERARCHY_REQUEST_ERR");
a=c(a,this.startContainer,this.startOffset);this.setStartBefore(a)},cloneContents:function(){G(this);var a,e;if(this.collapsed)return k(this).createDocumentFragment();if(this.startContainer===this.endContainer&&J(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),e=k(this).createDocumentFragment(),e.appendChild(a),e;e=new r(this,!0);a=q(e);e.detach();return a},canSurroundContents:function(){G(this);fa(this.startContainer);fa(this.endContainer);
var a=new r(this,!0),e=a._first&&l(a._first,this)||a._last&&l(a._last,this);a.detach();return!e},surroundContents:function(a){x(a,la);if(!this.canSurroundContents())throw new P("INVALID_STATE_ERR");var e=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);c(a,this.startContainer,this.startOffset);a.appendChild(e);this.selectNode(a)},cloneRange:function(){G(this);for(var a=new $(k(this)),e=qa.length,b;e--;)b=qa[e],a[b]=this[b];return a},toString:function(){G(this);
var a=this.startContainer;if(a===this.endContainer&&J(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var e=[],a=new r(this,!0);p(a,function(a){3!=a.nodeType&&4!=a.nodeType||e.push(a.data)});a.detach();return e.join("")},compareNode:function(a){G(this);var e=a.parentNode,b=v(a);if(!e)throw new P("NOT_FOUND_ERR");a=this.comparePoint(e,b);e=this.comparePoint(e,b+1);return 0>a?0<e?ca:Z:0<e?da:ba},comparePoint:function(a,e){G(this);ja(a,"HIERARCHY_REQUEST_ERR");
ma(a,this.startContainer);return 0>T(a,e,this.startContainer,this.startOffset)?-1:0<T(a,e,this.endContainer,this.endOffset)?1:0},createContextualFragment:pa?function(a){var e=this.startContainer,b=M(e);if(!e)throw new P("INVALID_STATE_ERR");var c=null;1==e.nodeType?c=e:J(e)&&(c=E.parentElement(e));c=null===c||"HTML"==c.nodeName&&E.isHtmlNamespace(M(c).documentElement)&&E.isHtmlNamespace(c)?b.createElement("body"):c.cloneNode(!1);c.innerHTML=a;return E.fragmentFromNodeChildren(c)}:function(a){var e=
k(this).createElement("body");e.innerHTML=a;return E.fragmentFromNodeChildren(e)},toHtml:function(){return sa(this)},intersectsNode:function(a,e){G(this);ja(a,"NOT_FOUND_ERR");if(M(a)!==k(this))return!1;var b=a.parentNode,c=v(a);ja(b,"NOT_FOUND_ERR");var d=T(b,c,this.endContainer,this.endOffset),b=T(b,c+1,this.startContainer,this.startOffset);return e?0>=d&&0<=b:0>d&&0<b},isPointInRange:function(a,e){G(this);ja(a,"HIERARCHY_REQUEST_ERR");ma(a,this.startContainer);return 0<=T(a,e,this.startContainer,
this.startOffset)&&0>=T(a,e,this.endContainer,this.endOffset)},intersectsRange:function(a){return h(this,a,!1)},intersectsOrTouchesRange:function(a){return h(this,a,!0)},intersection:function(a){if(this.intersectsRange(a)){var e=T(this.startContainer,this.startOffset,a.startContainer,a.startOffset),b=T(this.endContainer,this.endOffset,a.endContainer,a.endOffset),c=this.cloneRange();-1==e&&c.setStart(a.startContainer,a.startOffset);1==b&&c.setEnd(a.endContainer,a.endOffset);return c}return null},union:function(a){if(this.intersectsOrTouchesRange(a)){var e=
this.cloneRange();-1==T(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&e.setStart(a.startContainer,a.startOffset);1==T(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&e.setEnd(a.endContainer,a.endOffset);return e}throw new P("Ranges do not intersect");},containsNode:function(a,e){return e?this.intersectsNode(a,!1):this.compareNode(a)==ba},containsNodeContents:function(a){return 0<=this.comparePoint(a,0)&&0>=this.comparePoint(a,Q(a))},containsRange:function(a){var e=
this.intersection(a);return null!==e&&a.equals(e)},containsNodeText:function(a){var e=this.cloneRange();e.selectNode(a);var b=e.getNodes([3]);return 0<b.length?(e.setStart(b[0],0),a=b.pop(),e.setEnd(a,a.length),this.containsRange(e)):this.containsNodeContents(a)},getNodes:function(a,e){G(this);return s(this,a,e)},getDocument:function(){return k(this)},collapseBefore:function(a){this.setEndBefore(a);this.collapse(!1)},collapseAfter:function(a){this.setStartAfter(a);this.collapse(!0)},getBookmark:function(e){var b=
k(this),c=a.createRange(b);e=e||E.getBody(b);c.selectNodeContents(e);var b=this.intersection(c),d=0,z=0;b&&(c.setEnd(b.startContainer,b.startOffset),d=c.toString().length,z=d+b.toString().length);return{start:d,end:z,containerNode:e}},moveToBookmark:function(a){var e=a.containerNode,b=0;this.setStart(e,0);this.collapse(!0);for(var e=[e],c,d=!1,z=!1,f,g;!z&&(c=e.pop());)if(3==c.nodeType)f=b+c.length,!d&&(a.start>=b&&a.start<=f)&&(this.setStart(c,a.start-b),d=!0),d&&(a.end>=b&&a.end<=f)&&(this.setEnd(c,
a.end-b),z=!0),b=f;else for(g=c.childNodes,f=g.length;f--;)e.push(g[f])},getName:function(){return"DomRange"},equals:function(a){return $.rangesEqual(this,a)},isValid:function(){return A(this)},inspect:function(){return u(this)},detach:function(){}});B($,K);S.extend($,{rangeProperties:qa,RangeIterator:r,copyComparisonConstants:D,createPrototypeRange:B,inspect:u,toHtml:sa,getRangeDocument:k,rangesEqual:function(a,e){return a.startContainer===e.startContainer&&a.startOffset===e.startOffset&&a.endContainer===
e.endContainer&&a.endOffset===e.endOffset}});a.DomRange=$});m.createCoreModule("WrappedRange",["DomRange"],function(a,b){var l,k,f=a.dom,d=a.util,c=f.DomPosition,h=a.DomRange,p=f.getBody,q=f.getContentDocument,n=f.isCharacterDataNode;a.features.implementsDomRange&&function(){function c(a){for(var b=x.length,d;b--;)d=x[b],a[d]=a.nativeRange[d];a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset}var t,x=h.rangeProperties,k;l=function(a){if(!a)throw b.createError("WrappedRange: Range must be specified");
this.nativeRange=a;c(this)};h.createPrototypeRange(l,function(a,b,c,d,f){var g=a.startContainer!==b||a.startOffset!=c,h=a.endContainer!==d||a.endOffset!=f,t=!a.equals(a.nativeRange);if(g||h||t)a.setEnd(d,f),a.setStart(b,c)});t=l.prototype;t.selectNode=function(a){this.nativeRange.selectNode(a);c(this)};t.cloneContents=function(){return this.nativeRange.cloneContents()};t.surroundContents=function(a){this.nativeRange.surroundContents(a);c(this)};t.collapse=function(a){this.nativeRange.collapse(a);
c(this)};t.cloneRange=function(){return new l(this.nativeRange.cloneRange())};t.refresh=function(){c(this)};t.toString=function(){return this.nativeRange.toString()};var n=document.createTextNode("test");p(document).appendChild(n);var m=document.createRange();m.setStart(n,0);m.setEnd(n,0);try{m.setStart(n,1),t.setStart=function(a,b){this.nativeRange.setStart(a,b);c(this)},t.setEnd=function(a,b){this.nativeRange.setEnd(a,b);c(this)},k=function(a){return function(b){this.nativeRange[a](b);c(this)}}}catch(s){t.setStart=
function(a,b){try{this.nativeRange.setStart(a,b)}catch(d){this.nativeRange.setEnd(a,b),this.nativeRange.setStart(a,b)}c(this)},t.setEnd=function(a,b){try{this.nativeRange.setEnd(a,b)}catch(d){this.nativeRange.setStart(a,b),this.nativeRange.setEnd(a,b)}c(this)},k=function(a,b){return function(d){try{this.nativeRange[a](d)}catch(f){this.nativeRange[b](d),this.nativeRange[a](d)}c(this)}}}t.setStartBefore=k("setStartBefore","setEndBefore");t.setStartAfter=k("setStartAfter","setEndAfter");t.setEndBefore=
k("setEndBefore","setStartBefore");t.setEndAfter=k("setEndAfter","setStartAfter");t.selectNodeContents=function(a){this.setStartAndEnd(a,0,f.getNodeLength(a))};m.selectNodeContents(n);m.setEnd(n,3);k=document.createRange();k.selectNodeContents(n);k.setEnd(n,4);k.setStart(n,2);-1==m.compareBoundaryPoints(m.START_TO_END,k)&&1==m.compareBoundaryPoints(m.END_TO_START,k)?t.compareBoundaryPoints=function(a,b){b=b.nativeRange||b;a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END);return this.nativeRange.compareBoundaryPoints(a,
b)}:t.compareBoundaryPoints=function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)};k=document.createElement("div");k.innerHTML="123";var r=k.firstChild,u=p(document);u.appendChild(k);m.setStart(r,1);m.setEnd(r,2);m.deleteContents();"13"==r.data&&(t.deleteContents=function(){this.nativeRange.deleteContents();c(this)},t.extractContents=function(){var a=this.nativeRange.extractContents();c(this);return a});u.removeChild(k);u=null;d.isHostMethod(m,"createContextualFragment")&&
(t.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)});p(document).removeChild(n);t.getName=function(){return"WrappedRange"};a.WrappedRange=l;a.createNativeRange=function(a){a=q(a,b,"createNativeRange");return a.createRange()}}();if(a.features.implementsTextRange){var m=function(a,b,d,g,h){var l=a.duplicate();l.collapse(d);var k=l.parentElement();f.isOrIsAncestorOf(b,k)||(k=b);if(!k.canHaveHTML)return k=new c(k.parentNode,f.getNodeIndex(k)),{boundaryPosition:k,
nodeInfo:{nodeIndex:k.offset,containerElement:k.node}};b=f.getDocument(k).createElement("span");b.parentNode&&b.parentNode.removeChild(b);var p,m=d?"StartToStart":"StartToEnd",q=h&&h.containerElement==k?h.nodeIndex:0,s=k.childNodes.length,r=s;for(h=r;;){h==s?k.appendChild(b):k.insertBefore(b,k.childNodes[h]);l.moveToElementText(b);p=l.compareEndPoints(m,a);if(0==p||q==r)break;else if(-1==p)if(r==q+1)break;else q=h;else r=r==q+1?q:h;h=Math.floor((q+r)/2);k.removeChild(b)}m=b.nextSibling;if(-1==p&&
m&&n(m)){l.setEndPoint(d?"EndToStart":"EndToEnd",a);if(/[\r\n]/.test(m.data))for(d=l.duplicate(),g=d.text.replace(/\r\n/g,"\r").length,g=d.moveStart("character",g);-1==d.compareEndPoints("StartToEnd",d);)g++,d.moveStart("character",1);else g=l.text.length;d=new c(m,g)}else a=(g||!d)&&b.previousSibling,d=(d=(g||d)&&b.nextSibling)&&n(d)?new c(d,0):a&&n(a)?new c(a,a.data.length):new c(k,f.getNodeIndex(b));b.parentNode.removeChild(b);return{boundaryPosition:d,nodeInfo:{nodeIndex:h,containerElement:k}}},
s=function(a,b){var c,d,g=a.offset,h=f.getDocument(a.node),k=p(h).createTextRange(),l=n(a.node);l?(c=a.node,d=c.parentNode):(c=a.node.childNodes,c=g<c.length?c[g]:null,d=a.node);h=h.createElement("span");h.innerHTML="&#feff;";c?d.insertBefore(h,c):d.appendChild(h);k.moveToElementText(h);k.collapse(!b);d.removeChild(h);if(l)k[b?"moveStart":"moveEnd"]("character",g);return k};k=function(a){this.textRange=a;this.refresh()};k.prototype=new h(document);k.prototype.refresh=function(){var a,b,c;c=this.textRange;
a=c.parentElement();var d=c.duplicate();d.collapse(!0);b=d.parentElement();d=c.duplicate();d.collapse(!1);c=d.parentElement();b=b==c?b:f.getCommonAncestor(b,c);c=b==a?b:f.getCommonAncestor(a,b);0==this.textRange.compareEndPoints("StartToEnd",this.textRange)?b=a=m(this.textRange,c,!0,!0).boundaryPosition:(b=m(this.textRange,c,!0,!1),a=b.boundaryPosition,b=m(this.textRange,c,!1,!1,b.nodeInfo).boundaryPosition);this.setStart(a.node,a.offset);this.setEnd(b.node,b.offset)};k.prototype.getName=function(){return"WrappedTextRange"};
h.copyComparisonConstants(k);var r=function(a){if(a.collapsed)return s(new c(a.startContainer,a.startOffset),!0);var b=s(new c(a.startContainer,a.startOffset),!0),d=s(new c(a.endContainer,a.endOffset),!1);a=p(h.getRangeDocument(a)).createTextRange();a.setEndPoint("StartToStart",b);a.setEndPoint("EndToEnd",d);return a};k.rangeToTextRange=r;k.prototype.toTextRange=function(){return r(this)};a.WrappedTextRange=k;if(!a.features.implementsDomRange||a.config.preferTextRange){var u=Function("return this;")();
"undefined"==typeof u.Range&&(u.Range=k);a.createNativeRange=function(a){a=q(a,b,"createNativeRange");return p(a).createTextRange()};a.WrappedRange=k}}a.createRange=function(c){c=q(c,b,"createRange");return new a.WrappedRange(a.createNativeRange(c))};a.createRangyRange=function(a){a=q(a,b,"createRangyRange");return new h(a)};a.createIframeRange=function(c){b.deprecationNotice("createIframeRange()","createRange(iframeEl)");return a.createRange(c)};a.createIframeRangyRange=function(c){b.deprecationNotice("createIframeRangyRange()",
"createRangyRange(iframeEl)");return a.createRangyRange(c)};a.addShimListener(function(b){var c=b.document;"undefined"==typeof c.createRange&&(c.createRange=function(){return a.createRange(c)});c=b=null})});m.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(a,b){function l(a){return"string"==typeof a?/^backward(s)?$/i.test(a):!!a}function k(a,c){if(a){if(B.isWindow(a))return a;if(a instanceof w)return a.win;var d=B.getContentDocument(a,b,c);return B.getWindow(d)}return window}
function f(a){return k(a,"getWinSelection").getSelection()}function d(a){return k(a,"getDocSelection").document.selection}function c(a){var b=!1;a.anchorNode&&(b=1==B.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset));return b}function h(a,b,c){var d=c?"end":"start";c=c?"start":"end";a.anchorNode=b[d+"Container"];a.anchorOffset=b[d+"Offset"];a.focusNode=b[c+"Container"];a.focusOffset=b[c+"Offset"]}function m(a){a.anchorNode=a.focusNode=null;a.anchorOffset=a.focusOffset=0;a.rangeCount=
0;a.isCollapsed=!0;a._ranges.length=0}function n(b){var c;b instanceof K?(c=a.createNativeRange(b.getDocument()),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset)):b instanceof O?c=b.nativeRange:X.implementsDomRange&&b instanceof B.getWindow(b.startContainer).Range&&(c=b);return c}function p(a){var c=a.getNodes(),d;a:if(c.length&&1==c[0].nodeType){d=1;for(var f=c.length;d<f;++d)if(!B.isAncestorOf(c[0],c[d])){d=!1;break a}d=!0}else d=!1;if(!d)throw b.createError("getSingleElementFromRange: range "+
a.inspect()+" did not consist of a single element");return c[0]}function q(a){return!!a&&"undefined"!=typeof a.text}function r(a,b){var c=new O(b);a._ranges=[c];h(a,c,!1);a.rangeCount=1;a.isCollapsed=c.collapsed}function s(b){b._ranges.length=0;if("None"==b.docSelection.type)m(b);else{var c=b.docSelection.createRange();if(q(c))r(b,c);else{b.rangeCount=c.length;for(var d,f=L(c.item(0)),g=0;g<b.rangeCount;++g)d=a.createRange(f),d.selectNode(c.item(g)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&
b._ranges[0].collapsed;h(b,b._ranges[b.rangeCount-1],!1)}}}function u(a,c){for(var d=a.docSelection.createRange(),f=p(c),h=L(d.item(0)),h=$(h).createControlRange(),k=0,l=d.length;k<l;++k)h.add(d.item(k));try{h.add(f)}catch(m){throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");}h.select();s(a)}function w(a,b,c){this.nativeSelection=a;this.docSelection=b;this._ranges=[];this.win=c;this.refresh()}function t(a){a.win=a.anchorNode=
a.focusNode=a._ranges=null;a.rangeCount=a.anchorOffset=a.focusOffset=0;a.detached=!0}function x(a,b){for(var c=Z.length,d,f;c--;)if(d=Z[c],f=d.selection,"deleteAll"==b)t(f);else if(d.win==a)return"delete"==b?(Z.splice(c,1),!0):f;"deleteAll"==b&&(Z.length=0);return null}function A(a,c){for(var d=L(c[0].startContainer),d=$(d).createControlRange(),f=0,h,k=c.length;f<k;++f){h=p(c[f]);try{d.add(h)}catch(l){throw b.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)");
}}d.select();s(a)}function C(a,b){if(a.win.document!=L(b))throw new M("WRONG_DOCUMENT_ERR");}function D(b){return function(c,d){var f;this.rangeCount?(f=this.getRangeAt(0),f["set"+(b?"Start":"End")](c,d)):(f=a.createRange(this.win.document),f.setStartAndEnd(c,d));this.setSingleRange(f,this.isBackward())}}function F(a){var b=[],c=new U(a.anchorNode,a.anchorOffset),d=new U(a.focusNode,a.focusOffset),f="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var g=
0,h=a.rangeCount;g<h;++g)b[g]=K.inspect(a.getRangeAt(g));return"["+f+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.config.checkSelectionRanges=!0;var B=a.dom,I=a.util,G=I.isHostMethod,K=a.DomRange,O=a.WrappedRange,M=a.DOMException,U=B.DomPosition,N,Q,X=a.features,L=B.getDocument,$=B.getBody,E=K.rangesEqual,S=G(window,"getSelection"),R=I.isHostObject(document,"selection");X.implementsWinGetSelection=S;var P=(X.implementsDocSelection=R)&&(!S||a.config.preferTextRange);
P?(N=d,a.isSelectionValid=function(a){a=k(a,"isSelectionValid").document;var b=a.selection;return"None"!=b.type||L(b.createRange().parentElement())==a}):S?(N=f,a.isSelectionValid=function(){return!0}):b.fail("Neither document.selection or window.getSelection() detected.");a.getNativeSelection=N;var S=N(),J=a.createNativeRange(document),v=$(document),V=I.areHostProperties(S,["anchorNode","focusNode","anchorOffset","focusOffset"]);X.selectionHasAnchorAndFocus=V;var Y=G(S,"extend");X.selectionHasExtend=
Y;var T="number"==typeof S.rangeCount;X.selectionHasRangeCount=T;var aa=!1,ha=!0,ba=Y?function(b,c){var d=K.getRangeDocument(c),d=a.createRange(d);d.collapseToPoint(c.endContainer,c.endOffset);b.addRange(n(d));b.extend(c.startContainer,c.startOffset)}:null;I.areHostMethods(S,["addRange","getRangeAt","removeAllRanges"])&&("number"==typeof S.rangeCount&&X.implementsDomRange)&&function(){var b=window.getSelection();if(b){for(var d=b.rangeCount,f=1<d,g=[],h=c(b),k=0;k<d;++k)g[k]=b.getRangeAt(k);var k=
$(document),l=k.appendChild(document.createElement("div"));l.contentEditable="false";var m=l.appendChild(document.createTextNode("\u00a0\u00a0\u00a0")),n=document.createRange();n.setStart(m,1);n.collapse(!0);b.addRange(n);ha=1==b.rangeCount;b.removeAllRanges();f||((f=window.navigator.appVersion.match(/Chrome\/(.*?) /))&&36<=parseInt(f[1])?aa=!1:(f=n.cloneRange(),n.setStart(m,0),f.setEnd(m,3),f.setStart(m,2),b.addRange(n),b.addRange(f),aa=2==b.rangeCount));k.removeChild(l);b.removeAllRanges();for(k=
0;k<d;++k)0==k&&h?ba?ba(b,g[k]):(a.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),b.addRange(g[k])):b.addRange(g[k])}}();X.selectionSupportsMultipleRanges=aa;X.collapsedNonEditableSelectionsSupported=ha;var ga=!1;v&&G(v,"createControlRange")&&(v=v.createControlRange(),I.areHostProperties(v,["item","add"])&&(ga=!0));X.implementsControlRange=ga;Q=V?function(a){return a.anchorNode===a.focusNode&&
a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var ia;G(S,"getRangeAt")?ia=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:V&&(ia=function(b){var c=L(b.anchorNode),c=a.createRange(c);c.setStartAndEnd(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset);c.collapsed!==this.isCollapsed&&c.setStartAndEnd(b.focusNode,b.focusOffset,b.anchorNode,b.anchorOffset);return c});w.prototype=a.selectionPrototype;var Z=[],da=function(a){if(a&&
a instanceof w)return a.refresh(),a;a=k(a,"getNativeSelection");var b=x(a),c=N(a),f=R?d(a):null;b?(b.nativeSelection=c,b.docSelection=f,b.refresh()):(b=new w(c,f,a),Z.push({win:a,selection:b}));return b};a.getSelection=da;a.getIframeSelection=function(c){b.deprecationNotice("getIframeSelection()","getSelection(iframeEl)");return a.getSelection(B.getIframeWindow(c))};v=w.prototype;if(!P&&V&&I.areHostMethods(S,["removeAllRanges","addRange"]))v.removeAllRanges=function(){this.nativeSelection.removeAllRanges();
m(this)},v.addRange=T?function(b,c){if(ga&&R&&"Control"==this.docSelection.type)u(this,b);else if(l(c)&&Y)ba(this.nativeSelection,b),this.refresh();else{var d;aa?d=this.rangeCount:(this.removeAllRanges(),d=0);var f=n(b).cloneRange();try{this.nativeSelection.addRange(f)}catch(g){}this.rangeCount=this.nativeSelection.rangeCount;this.rangeCount==d+1?(a.config.checkSelectionRanges&&(d=ia(this.nativeSelection,this.rangeCount-1))&&!E(d,b)&&(b=new O(d)),this._ranges[this.rangeCount-1]=b,h(this,b,la(this.nativeSelection)),
this.isCollapsed=Q(this)):this.refresh()}}:function(a,b){l(b)&&Y?ba(this.nativeSelection,a):this.nativeSelection.addRange(n(a));this.refresh()},v.setRanges=function(a){if(ga&&R&&1<a.length)A(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;b<c;++b)this.addRange(a[b])}};else if(G(S,"empty")&&G(J,"select")&&ga&&P)v.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;if(this.anchorNode)a=L(this.anchorNode);else if("Control"==this.docSelection.type){var b=
this.docSelection.createRange();b.length&&(a=L(b.item(0)))}a&&($(a).createTextRange().select(),this.docSelection.empty())}}catch(c){}m(this)},v.addRange=function(b){"Control"==this.docSelection.type?u(this,b):(a.WrappedTextRange.rangeToTextRange(b).select(),this._ranges[0]=b,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,h(this,b,!1))},v.setRanges=function(a){this.removeAllRanges();var b=a.length;1<b?A(this,a):b&&this.addRange(a[0])};else return b.fail("No means of selecting a Range or TextRange was found"),
!1;v.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new M("INDEX_SIZE_ERR");return this._ranges[a].cloneRange()};var ca;if(P)ca=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=$(b.win.document).createTextRange(),c.collapse(!0));"Control"==b.docSelection.type?s(b):q(c)?r(b,c):m(b)};else if(G(S,"getRangeAt")&&"number"==typeof S.rangeCount)ca=function(b){if(ga&&R&&"Control"==b.docSelection.type)s(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,
b.rangeCount){for(var c=0,d=b.rangeCount;c<d;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));h(b,b._ranges[b.rangeCount-1],la(b.nativeSelection));b.isCollapsed=Q(b)}else m(b)};else if(V&&"boolean"==typeof S.isCollapsed&&"boolean"==typeof J.collapsed&&X.implementsDomRange)ca=function(a){var b;b=a.nativeSelection;b.anchorNode?(b=ia(b,0),a._ranges=[b],a.rangeCount=1,b=a.nativeSelection,a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=
b.focusOffset,a.isCollapsed=Q(a)):m(a)};else return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;v.refresh=function(a){var b=a?this._ranges.slice(0):null,c=this.anchorNode,d=this.anchorOffset;ca(this);if(a){a=b.length;if(a!=this._ranges.length||this.anchorNode!=c||this.anchorOffset!=d)return!0;for(;a--;)if(!E(b[a],this._ranges[a]))return!0;return!1}};var ka=function(a,b){var c=a.getAllRanges();a.removeAllRanges();for(var d=0,f=c.length;d<f;++d)E(b,c[d])||
a.addRange(c[d]);a.rangeCount||m(a)};v.removeRange=ga&&R?function(a){if("Control"==this.docSelection.type){var b=this.docSelection.createRange();a=p(a);for(var c=L(b.item(0)),c=$(c).createControlRange(),d,f=!1,g=0,h=b.length;g<h;++g)d=b.item(g),d!==a||f?c.add(b.item(g)):f=!0;c.select();s(this)}else ka(this,a)}:function(a){ka(this,a)};var la;!P&&V&&X.implementsDomRange?(la=c,v.isBackward=function(){return la(this)}):la=v.isBackward=function(){return!1};v.isBackwards=v.isBackward;v.toString=function(){for(var a=
[],b=0,c=this.rangeCount;b<c;++b)a[b]=""+this._ranges[b];return a.join("")};v.collapse=function(b,c){C(this,b);var d=a.createRange(b);d.collapseToPoint(b,c);this.setSingleRange(d);this.isCollapsed=!0};v.collapseToStart=function(){if(this.rangeCount){var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)}else throw new M("INVALID_STATE_ERR");};v.collapseToEnd=function(){if(this.rangeCount){var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)}else throw new M("INVALID_STATE_ERR");
};v.selectAllChildren=function(b){C(this,b);var c=a.createRange(b);c.selectNodeContents(b);this.setSingleRange(c)};v.deleteFromDocument=function(){if(ga&&R&&"Control"==this.docSelection.type){for(var a=this.docSelection.createRange(),b;a.length;)b=a.item(0),a.remove(b),b.parentNode.removeChild(b);this.refresh()}else if(this.rangeCount&&(a=this.getAllRanges(),a.length)){this.removeAllRanges();b=0;for(var c=a.length;b<c;++b)a[b].deleteContents();this.addRange(a[c-1])}};v.eachRange=function(a,b){for(var c=
0,d=this._ranges.length;c<d;++c)if(a(this.getRangeAt(c)))return b};v.getAllRanges=function(){var a=[];this.eachRange(function(b){a.push(b)});return a};v.setSingleRange=function(a,b){this.removeAllRanges();this.addRange(a,b)};v.callMethodOnEachRange=function(a,b){var c=[];this.eachRange(function(d){c.push(d[a].apply(d,b))});return c};v.setStart=D(!0);v.setEnd=D(!1);a.rangePrototype.select=function(a){da(this.getDocument()).setSingleRange(this,a)};v.changeEachRange=function(a){var b=[],c=this.isBackward();
this.eachRange(function(c){a(c);b.push(c)});this.removeAllRanges();c&&1==b.length?this.addRange(b[0],"backward"):this.setRanges(b)};v.containsNode=function(a,b){return this.eachRange(function(c){return c.containsNode(a,b)},!0)||!1};v.getBookmark=function(a){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[a])}};v.moveToBookmark=function(b){for(var c=[],d=0,f,g;f=b.rangeBookmarks[d++];)g=a.createRange(this.win),g.moveToBookmark(f),c.push(g);b.backward?this.setSingleRange(c[0],
"backward"):this.setRanges(c)};v.toHtml=function(){var a=[];this.eachRange(function(b){a.push(K.toHtml(b))});return a.join("")};X.implementsTextRange&&(v.getNativeTextRange=function(){var c;if(c=this.docSelection){c=c.createRange();if(q(c))return c;throw b.createError("getNativeTextRange: selection is a control selection");}if(0<this.rangeCount)return a.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw b.createError("getNativeTextRange: selection contains no range");});v.getName=function(){return"WrappedSelection"};
v.inspect=function(){return F(this)};v.detach=function(){x(this.win,"delete");t(this)};w.detachAll=function(){x(null,"deleteAll")};w.inspect=F;w.isDirectionBackward=l;a.Selection=w;a.selectionPrototype=v;a.addShimListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return da(a)});a=null})});var ca=!1,L=function(a){ca||(ca=!0,!m.initialized&&m.config.autoInitialize&&Q())};M&&(/^(?:complete|interactive)$/.test(document.readyState)?L():(A(document,"addEventListener")&&
document.addEventListener("DOMContentLoaded",L,!1),Z(window,"load",L)));return m},this);
